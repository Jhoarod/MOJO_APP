services:
  core_app:
    build:
      context: .
      dockerfile: Dockerfile
    container_name: core_app
    restart: on-failure
    ports:
      - "8080:8080"
    depends_on:
      - personas_db
      - articulos_db
      - ventas_db
    environment:
      - MOJO_MODE=production
      - SQLITE_DB=/app/data/almacen.sqlite
      - MONGO_PERSONAS=mongodb://personas_db:27017/personas_db
      - MONGO_ARTICULOS=mongodb://articulos_db:27017/articulos_db
      - MONGO_VENTAS=mongodb://ventas_db:27017/ventas_db
    volumes:
      - "C:/Users/USER/Downloads/P_SC_MOJO/proyectoSegundoCorteBDM/data:/app/data"

  personas_db:
    image: mongo:6.0
    container_name: personas_db
    ports:
      - "27018:27017"
    volumes:
      - ./mongo_data/personas:/data/db
      - "C:/Users/USER/Downloads/P_SC_MOJO/proyectoSegundoCorteBDM/data:/app/data"
    command: ["mongod", "--dbpath", "/data/db"]

  articulos_db:
    image: mongo:6.0
    container_name: articulos_db
    ports:
      - "27019:27017"
    volumes:
      - ./mongo_data/articulos:/data/db
      - "C:/Users/USER/Downloads/P_SC_MOJO/proyectoSegundoCorteBDM/data:/app/data"
    command: ["mongod", "--dbpath", "/data/db"]

  ventas_db:
    image: mongo:6.0
    container_name: ventas_db
    ports:
      - "27020:27017"
    volumes:
      - ./mongo_data/ventas:/data/db
      - "C:/Users/USER/Downloads/P_SC_MOJO/proyectoSegundoCorteBDM/data:/app/data"
    command: ["mongod", "--dbpath", "/data/db"]
